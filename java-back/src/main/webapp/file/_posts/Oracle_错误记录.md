---
title: Oracle_错误记录
date: 2016-04-24  15:03:21
tags: Oracle
categories: Oracle
---


一.目录
=================================

1. 监听程序无法分发客户机连接
2. 如何删除--计算机管理里的服务
3. 如何删除主外键关联的表
4. 失误删除spfile
5. 无法通过命令开启oracleServiceNAME服务
6. 误删了Oracle数据库某个表空间的数据文件
7. 协议适配器错误
8. 远程访问数据库可能出现的错误
9. ORA-12514:TNS:监听程序无法识别连接描述符中请求的服务
10. 将excel表导入数据库
11. Oracel逻辑备份两个工具	
12. 如何修改最大连接数




---
<br><br><br>


二.错误
=================================

1.监听程序无法分发客户机连接
-----------------------------
```
            sqlplus/nolog
            conn system/liushuwei @10.3.62.27/name
                    ------->出现错误监听程序无法分发客户机连接
                （未解决）
```

尝试解决一：       ---------失败
```
    在E:\Java\Oracle\software\NETWORK\ADMIN路径下




    修改：listener.ora

    首行添加：
        DIRECT_HANDOFF_TTC_LISTENER = OFF 
    
    添加
    (SID_DESC = 
      (GLOBAL_DBNAME = name) 
      (ORACLE_HOME = E:\Java\Oracle\software) 
      (SID_NAME = name.Suvan) 
       ) 

    修改文件后
    行以下命令重启监听器和EM

    lsnrctl stop 
    lsnrctl start
    下面这两个命令提示报错
    emctl stop dbconsole
    emctl start dbconsole


    (Evironment varibale ORACLE_UNQNAME not defined .
    Please set ORACLE_UNQNAME to database unique name
        ----
        ORACLE_UNQNAME环境变量没有定义。
        请设置ORACLE_UNQNAME数据库唯一的名称)
```
---
<br><br>



2.如何删除--计算机管理里的服务
-----------------------------------
使用管理员身份，
登录命令提示符

sc delete 服务名字
　　 例如：sc delete MySOL

---
<br><br>


3.如何删除主外键关联的表
------------------------------
如果是单方向的外键关联的时候：先删子表，然后删父表就可实现了。
命令为：
　　    drop table tablename；

+ 1.如果两张表相互有主外键约束命令为
　　drop table tablename cascade constraints
　　　　　　　　只删除其中的一个即可完成两张表的同时删除。 

2.先删除外键，再删除表
　　 alter table 表名 drop constraint 外键名;

　　删除主键
　　 alter table XXX drop primary key cascade;

---
<br><br>




4.失误删除spfile
----------------------------
　　        ----21:14 2016/3/6
失误删除Oracle 11g的SPFILENAME.ORA,导致无法启动Oracle
(E:\Java\Oracle\software\database下的
SPFILENAME.ORA不见了！！！！！)

文件恢复方法

```
找到目录E:\Java\Oracle\admin\name\pfile下的
int.ora.23201619496文件

通过pfile 启动数据
        startup pfile='',、
然后再通过create spfile from pfile 重建spfile; 


回到C：>命令行

输入以下命令，通过原始存档重建spfile
        sqlplus /nolog
        conn / as sysdba;
        create spfile='D:\oracle\product\10.2.0\db_1\dbs\SPFILETESTING.ORA' 
        from pfile='D:\oracle\product\10.2.0\admin\testing\pfile\init.ora.913200824649'; 

然后Oracle又可以启动啦
```
---
<br><br>



5.无法通过命令开启oracleServiceNAME服务
-----------------------

过dos命令启动oracle服务时遇到问题：
```
　　net start oracleserviceORCL

　    net start 
            发生系统错误 5。

            拒绝访问。
```

解决

系统是vista，默认用cmd打开的是没有管理员权限的，
附件--命令提示符 右键 以管理员身份运行 即可解决问题

 ```
　　以管理员身份登录DOS
　  net start oracleserviceORCL
    neoracleserviceORCL 服务正在启动 .
    oracleserviceORCL 服务已经启动成功。
```

---
<br><br>


6.误删了Oracle数据库某个表空间的数据文件
------------------------

误删了某个表空间的数据文件，

导致数据库conn system/liushuwei 无法连接，报错


解决办法：
```
    sqlpLus/nolg

        conn / as sysdba

        startup,stutdown 

        alter database datafile '删除文件目录/删除文件名.DBF' offline drop


        exit

            net stop oracleServiceORCL

            net start oracleServiceORCL
```


>为什么system进去不去，但是sys可以进去？


可以重新连接system用户后，
　　    select file_name from dba_data_files 

查询控制文件
　　但是仍然会显示出已经删除的控制文件的记录
　　但是文件夹中已经没有该文件了，

原因:是数据字典v$database中任然保留这个记录，但是并不会占硬盘空间

如果要彻底删除，则需要连表空间一起删除
删除表空间 同时删除控制文件：
　　drop tablespace tpname including contents and datafiles;


---
<br><br>



7.协议适配器错误
-------------------
右键我的电脑--->管理--->服务--->找到oracleServierOCRL,重新启动

通过管理员身份，登录dos界面
　　   net start oracleserviceNAME

---
<br><br>



8.远程访问数据库可能出现的错误
--------------------------------------
+ 1.连接超时
　　对方防火墙没关闭

+ 2.无监听程序
　　对方未重新配置监听程序

+ 3.监听程序当前无法识别连接描述符中请求服务
　　对方需打开DOS界面，输入 set oracle_sid=orcl
　　     (对方数据库名字是orcl)
+ 4.账户锁定
　　对方账户已被锁定了，配置成功但无法访问啦


另一种小方法

A开WIFI热点，BCD连A的WIFI
　　    其他网络配置，监听程序配置一样

　　    A可以绕过BCD的防火墙访问他们的数据库了


---
<br><br>




9.ORA-12514:TNS:监听程序无法识别连接描述符中请求的服务
-----------------------------

问题描述
&emsp;开启PLSQL时候，使用system用户，输入密码确认后，报错“ORA-12514:TNS:监听程序无法识别连接描述符中请求的服务”


解决思路
1. 重启OracleServiceORCL和OracleOraDb11g_home2TNSListener服务
2.PLSQL工具的配置问题
```
...\PLSQL\instantclient_11_2目录下的tnsnamees.or文件【根据下面模版，需要添加tnsnames.ora的路径和监听器】

# tnsnames.ora Network Configuration File: E:\Java\eclipse_YanYunDDS_Project\Workspace2_ImportData\PLSQL\instantclient_11_2\tnsnames.ora
# Generated by Oracle configuration tools.

LISTENER_ORCL =
  (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))

ORCL =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orcl)
    )
  )


```
---
<br><br>


10.将excel表导入数据库
----------------
```
1.文件转格式(xlsx ->  (制表符分隔)*.txt)
    顶部菜单栏 ->    文件
        另存为
            保存类型选择[文本文件(制表符分隔)(*.txt)] ->   保存


2.建表
    开启sqlplus：sqlplust/nolog
        连接： conn 用户名/密码
            CREATE TABLE student(
                sid CHAR(12),
                name VARCHAR2(20),
                sex CHAR(1 char),
                sclass  VARCHAR2(20)
            );


3.创建控制文件
    创建txt文本【与重新保存的(制表符分隔)*.txt路径相同】
        将后缀改为.ctl
            添加内容
                load data                   [控制文件标识]
                infile 'student.txt'        [要输入的数据文件名为test.txt] 
                append into table student   [向表test中追加记录]
                fields terminated by X'09'  [字段终止于X’09'，是一个制表符(TAB)]
                (sid,name,sex,sclass)       [数据库表中对应的四个字段名] 


4.导入数据
    DOS窗体里输入： sqlldr userid=用户名/密码@服务名 control=input.cpl

```
---
<br><br>


11.Oracel逻辑备份两个工具
-----------------------

这两个命令是当前windows系统路径，不是在sqlplus
exp 导出工具 逻辑备份文件，dmp文件
imp 导入工具

注意：
+ dmb文件只用于导入导出的时候使用
+ 导入的时候，不忽略警告，因为有重复会自动终止的（如果没有这个用户，那么导入的时候要新建用户）



---
<br><br>


12.如何修改最大连接数
-------------------
```
登录sqlplus
    查看最大连接数： select value from V$parameter where name='processes';
    查看当前连接数： select count (*) from V$process;
        修改最大连接数：alter system set processes=300 scope=spfile
            重启数据库：
                shutdown immediate;
                startup;


```


---
<br><br>